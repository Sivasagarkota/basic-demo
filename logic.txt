this is logic for database